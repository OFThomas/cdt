Spatial modes = 4
Spectral modes = 1
Total dim = 4

 Two mode squeezing on modes,  0 , 1
Two mode squeezer on modes,  2 , 3
Phase shift on modes.  2 phase angle pi/2
Beamsplitter on modes,  1 , 2 angle=  pi/4

 mode transform
False

C matrix

⎡cosh(r)     0     0  0⎤
⎢                      ⎥
⎢   0     cosh(r)  0  0⎥
⎢                      ⎥
⎢   0        0     1  0⎥
⎢                      ⎥
⎣   0        0     0  1⎦

S matrix

⎡   0     sinh(r)  0  0⎤
⎢                      ⎥
⎢sinh(r)     0     0  0⎥
⎢                      ⎥
⎢   0        0     0  0⎥
⎢                      ⎥
⎣   0        0     0  0⎦


 mode transform
False

C matrix

⎡cosh(r)     0        0        0   ⎤
⎢                                  ⎥
⎢   0     cosh(r)     0        0   ⎥
⎢                                  ⎥
⎢   0        0     cosh(r)     0   ⎥
⎢                                  ⎥
⎣   0        0        0     cosh(r)⎦

S matrix

⎡   0     sinh(r)     0        0   ⎤
⎢                                  ⎥
⎢sinh(r)     0        0        0   ⎥
⎢                                  ⎥
⎢   0        0        0     sinh(r)⎥
⎢                                  ⎥
⎣   0        0     sinh(r)     0   ⎦


 mode transform
False

C matrix

⎡cosh(r)        0           0        0   ⎤
⎢                                        ⎥
⎢          ⅈ⋅θ₀                          ⎥
⎢   0     ℯ    ⋅cosh(r)     0        0   ⎥
⎢                                        ⎥
⎢   0           0        cosh(r)     0   ⎥
⎢                                        ⎥
⎣   0           0           0     cosh(r)⎦

S matrix

⎡      0        sinh(r)     0        0   ⎤
⎢                                        ⎥
⎢ ⅈ⋅θ₀                                   ⎥
⎢ℯ    ⋅sinh(r)     0        0        0   ⎥
⎢                                        ⎥
⎢      0           0        0     sinh(r)⎥
⎢                                        ⎥
⎣      0           0     sinh(r)     0   ⎦


 mode transform
False

C matrix

⎡cosh(r)            0                    0             0   ⎤
⎢                                                          ⎥
⎢           ⅈ⋅θ₀                                           ⎥
⎢   0      ℯ    ⋅cos(φ)⋅cosh(r)   ⅈ⋅sin(φ)⋅cosh(r)     0   ⎥
⎢                                                          ⎥
⎢            ⅈ⋅θ₀                                          ⎥
⎢   0     ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(r)   cos(φ)⋅cosh(r)      0   ⎥
⎢                                                          ⎥
⎣   0               0                    0          cosh(r)⎦

S matrix

⎡          0             sinh(r)     0            0        ⎤
⎢                                                          ⎥
⎢  ⅈ⋅θ₀                                                    ⎥
⎢ ℯ    ⋅cos(φ)⋅sinh(r)      0        0     ⅈ⋅sin(φ)⋅sinh(r)⎥
⎢                                                          ⎥
⎢   ⅈ⋅θ₀                                                   ⎥
⎢ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r)     0        0      cos(φ)⋅sinh(r) ⎥
⎢                                                          ⎥
⎣          0                0     sinh(r)         0        ⎦


C matrix

⎡cosh(r)            0                    0             0   ⎤
⎢                                                          ⎥
⎢           ⅈ⋅θ₀                                           ⎥
⎢   0      ℯ    ⋅cos(φ)⋅cosh(r)   ⅈ⋅sin(φ)⋅cosh(r)     0   ⎥
⎢                                                          ⎥
⎢            ⅈ⋅θ₀                                          ⎥
⎢   0     ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(r)   cos(φ)⋅cosh(r)      0   ⎥
⎢                                                          ⎥
⎣   0               0                    0          cosh(r)⎦

S matrix

⎡          0             sinh(r)     0            0        ⎤
⎢                                                          ⎥
⎢  ⅈ⋅θ₀                                                    ⎥
⎢ ℯ    ⋅cos(φ)⋅sinh(r)      0        0     ⅈ⋅sin(φ)⋅sinh(r)⎥
⎢                                                          ⎥
⎢   ⅈ⋅θ₀                                                   ⎥
⎢ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r)     0        0      cos(φ)⋅sinh(r) ⎥
⎢                                                          ⎥
⎣          0                0     sinh(r)         0        ⎦

False
          ⎡        cosh(r)                     0                    0                  0                    0                     sinh(r)                   0                 0        ⎤                
          ⎢                                                                                                                                                                            ⎥                
⎡b(0) ⎤   ⎢                            ⅈ⋅θ₀                                                         ⅈ⋅θ₀                                                                               ⎥ ⎡⎡b(0)⎤ ⎤      
⎢     ⎥   ⎢           0               ℯ    ⋅cos(φ)⋅cosh(r)   ⅈ⋅sin(φ)⋅cosh(r)          0           ℯ    ⋅cos(φ)⋅sinh(r)              0                      0          ⅈ⋅sin(φ)⋅sinh(r)⎥ ⎢⎢    ⎥ ⎥      
⎢b(1) ⎥   ⎢                                                                                                                                                                            ⎥ ⎢⎢b(1)⎥ ⎥      
⎢     ⎥   ⎢                             ⅈ⋅θ₀                                                         ⅈ⋅θ₀                                                                              ⎥ ⎢⎢    ⎥ ⎥      
⎢b(2) ⎥   ⎢           0              ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(r)   cos(φ)⋅cosh(r)           0          ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r)             0                      0           cos(φ)⋅sinh(r) ⎥ ⎢⎢b(2)⎥ ⎥      
⎢     ⎥   ⎢                                                                                                                                                                            ⎥ ⎢⎢    ⎥ ⎥      
⎢b(3) ⎥   ⎢           0                        0                    0               cosh(r)                 0                        0                   sinh(r)              0        ⎥ ⎢⎣b(3)⎦ ⎥      
⎢     ⎥ = ⎢                                                                                                                                                                            ⎥⋅⎢       ⎥[:8, ]
⎢b+(0)⎥   ⎢           0                     sinh(r)                 0                  0                 cosh(r)                     0                      0                 0        ⎥ ⎢⎡b+(0)⎤⎥      
⎢     ⎥   ⎢                                                                                                                                                                            ⎥ ⎢⎢     ⎥⎥      
⎢b+(1)⎥   ⎢  -ⅈ⋅θ₀                                                                                                          -ⅈ⋅θ₀                                                      ⎥ ⎢⎢b+(1)⎥⎥      
⎢     ⎥   ⎢ ℯ     ⋅cos(φ)⋅sinh(r)              0                    0          -ⅈ⋅sin(φ)⋅sinh(r)            0              ℯ     ⋅cos(φ)⋅cosh(r)    -ⅈ⋅sin(φ)⋅cosh(r)         0        ⎥ ⎢⎢     ⎥⎥      
⎢b+(2)⎥   ⎢                                                                                                                                                                            ⎥ ⎢⎢b+(2)⎥⎥      
⎢     ⎥   ⎢    -ⅈ⋅θ₀                                                                                                          -ⅈ⋅θ₀                                                    ⎥ ⎢⎢     ⎥⎥      
⎣b+(3)⎦   ⎢-ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(r)            0                    0           cos(φ)⋅sinh(r)              0             -ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(r)   cos(φ)⋅cosh(r)           0        ⎥ ⎣⎣b+(3)⎦⎦      
          ⎢                                                                                                                                                                            ⎥                
          ⎣           0                        0                 sinh(r)               0                    0                        0                      0              cosh(r)     ⎦                














b(0) = sinh(r)⋅b+(1) + cosh(r)⋅b(0)
        ⅈ⋅θ₀                         ⅈ⋅θ₀                                                                     
b(1) = ℯ    ⋅cos(φ)⋅sinh(r)⋅b+(0) + ℯ    ⋅cos(φ)⋅cosh(r)⋅b(1) + ⅈ⋅sin(φ)⋅sinh(r)⋅b+(3) + ⅈ⋅sin(φ)⋅cosh(r)⋅b(2)
          ⅈ⋅θ₀                           ⅈ⋅θ₀                                                                 
b(2) = ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r)⋅b+(0) + ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(r)⋅b(1) + cos(φ)⋅sinh(r)⋅b+(3) + cos(φ)⋅cosh(r)⋅b(2)
b(3) = sinh(r)⋅b+(2) + cosh(r)⋅b(3)
b+(0) = sinh(r)⋅b(1) + cosh(r)⋅b+(0)
                                                           -ⅈ⋅θ₀                        -ⅈ⋅θ₀                     
b+(1) = -ⅈ⋅sin(φ)⋅sinh(r)⋅b(3) - ⅈ⋅sin(φ)⋅cosh(r)⋅b+(2) + ℯ     ⋅cos(φ)⋅sinh(r)⋅b(0) + ℯ     ⋅cos(φ)⋅cosh(r)⋅b+(1)
                                                        -ⅈ⋅θ₀                          -ⅈ⋅θ₀                     
b+(2) = cos(φ)⋅sinh(r)⋅b(3) + cos(φ)⋅cosh(r)⋅b+(2) - ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(r)⋅b(0) - ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(r)⋅b+(1)
b+(3) = sinh(r)⋅b(2) + cosh(r)⋅b+(3)





Comutator is
[sinh(r)⋅b+(1) + cosh(r)⋅b(0)
,
 ⅈ⋅θ₀                         ⅈ⋅θ₀                                                                     
ℯ    ⋅cos(φ)⋅sinh(r)⋅b+(0) + ℯ    ⋅cos(φ)⋅cosh(r)⋅b(1) + ⅈ⋅sin(φ)⋅sinh(r)⋅b+(3) + ⅈ⋅sin(φ)⋅cosh(r)⋅b(2)
]

 Which evaluates to:
0

Comutator is
[sinh(r)⋅b+(1) + cosh(r)⋅b(0)
,
sinh(r)⋅b(1) + cosh(r)⋅b+(0)
]

 Which evaluates to:
      2          2   
- sinh (r) + cosh (r)
⎡        cosh(r)                     0                    0                  0                    0                     sinh(r)                   0                 0        ⎤                
⎢                                                                                                                                                                            ⎥                
⎢                            ⅈ⋅θ₀                                                         ⅈ⋅θ₀                                                                               ⎥ ⎡⎡b(0)⎤ ⎤      
⎢           0               ℯ    ⋅cos(φ)⋅cosh(r)   ⅈ⋅sin(φ)⋅cosh(r)          0           ℯ    ⋅cos(φ)⋅sinh(r)              0                      0          ⅈ⋅sin(φ)⋅sinh(r)⎥ ⎢⎢    ⎥ ⎥      
⎢                                                                                                                                                                            ⎥ ⎢⎢b(1)⎥ ⎥      
⎢                             ⅈ⋅θ₀                                                         ⅈ⋅θ₀                                                                              ⎥ ⎢⎢    ⎥ ⎥      
⎢           0              ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(r)   cos(φ)⋅cosh(r)           0          ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r)             0                      0           cos(φ)⋅sinh(r) ⎥ ⎢⎢b(2)⎥ ⎥      
⎢                                                                                                                                                                            ⎥ ⎢⎢    ⎥ ⎥      
⎢           0                        0                    0               cosh(r)                 0                        0                   sinh(r)              0        ⎥ ⎢⎣b(3)⎦ ⎥      
⎢                                                                                                                                                                            ⎥⋅⎢       ⎥[:8, ]
⎢           0                     sinh(r)                 0                  0                 cosh(r)                     0                      0                 0        ⎥ ⎢⎡b+(0)⎤⎥      
⎢                                                                                                                                                                            ⎥ ⎢⎢     ⎥⎥      
⎢  -ⅈ⋅θ₀                                                                                                          -ⅈ⋅θ₀                                                      ⎥ ⎢⎢b+(1)⎥⎥      
⎢ ℯ     ⋅cos(φ)⋅sinh(r)              0                    0          -ⅈ⋅sin(φ)⋅sinh(r)            0              ℯ     ⋅cos(φ)⋅cosh(r)    -ⅈ⋅sin(φ)⋅cosh(r)         0        ⎥ ⎢⎢     ⎥⎥      
⎢                                                                                                                                                                            ⎥ ⎢⎢b+(2)⎥⎥      
⎢    -ⅈ⋅θ₀                                                                                                          -ⅈ⋅θ₀                                                    ⎥ ⎢⎢     ⎥⎥      
⎢-ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(r)            0                    0           cos(φ)⋅sinh(r)              0             -ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(r)   cos(φ)⋅cosh(r)           0        ⎥ ⎣⎣b+(3)⎦⎦      
⎢                                                                                                                                                                            ⎥                
⎣           0                        0                 sinh(r)               0                    0                        0                      0              cosh(r)     ⎦                

 gamma 

   4        4        4           2       2        4        4         4        4        4   
sin (φ)⋅sinh (r)⋅cosh (r) - 2⋅sin (φ)⋅cos (φ)⋅sinh (r)⋅cosh (r) + cos (φ)⋅sinh (r)⋅cosh (r)

BBdag diag terms

                                     2         
⎛   2        2         2        2   ⎞      4   
⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠ ⋅sinh (r)

G4

                                     2                                                                                                                                                                           
⎛   2        2         2        2   ⎞      4        ⎛   2        2         2        2   ⎞    2        4        2        ⎛   2        2         2        2   ⎞    2        4        2         4        4        4 
⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠ ⋅sinh (r) + 2⋅⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠⋅sin (φ)⋅sinh (r)⋅cosh (r) + 2⋅⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠⋅cos (φ)⋅sinh (r)⋅cosh (r) + sin (φ)⋅sinh (r)⋅cosh (

                                                                    
          2       2        4        4         4        4        4   
r) - 2⋅sin (φ)⋅cos (φ)⋅sinh (r)⋅cosh (r) + cos (φ)⋅sinh (r)⋅cosh (r)

Simplified

                                     2                                                                                                                                                                           
⎛   2        2         2        2   ⎞      4        ⎛   2        2         2        2   ⎞    2        4        2        ⎛   2        2         2        2   ⎞    2        4        2         4        4        4 
⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠ ⋅sinh (r) + 2⋅⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠⋅sin (φ)⋅sinh (r)⋅cosh (r) + 2⋅⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠⋅cos (φ)⋅sinh (r)⋅cosh (r) + sin (φ)⋅sinh (r)⋅cosh (

                                                                    
          2       2        4        4         4        4        4   
r) - 2⋅sin (φ)⋅cos (φ)⋅sinh (r)⋅cosh (r) + cos (φ)⋅sinh (r)⋅cosh (r)

 no beamsplitter

    8            6        2          4        4   
sinh (r) + 2⋅sinh (r)⋅cosh (r) + sinh (r)⋅cosh (r)
answer




 help?
                                     2                                                                                                                                                                           
⎛   2        2         2        2   ⎞      4        ⎛   2        2         2        2   ⎞    2        4        2        ⎛   2        2         2        2   ⎞    2        4        2         4        4        4 
⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠ ⋅sinh (r) + 2⋅⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠⋅sin (φ)⋅sinh (r)⋅cosh (r) + 2⋅⎝sin (φ)⋅sinh (r) + cos (φ)⋅sinh (r)⎠⋅cos (φ)⋅sinh (r)⋅cosh (r) + sin (φ)⋅sinh (r)⋅cosh (
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                                      8            6        2          4        4                                                
                                                                                                                  sinh (r) + 2⋅sinh (r)⋅cosh (r) + sinh (r)⋅cosh (r)                                             

                                                                    
          2       2        4        4         4        4        4   
r) - 2⋅sin (φ)⋅cos (φ)⋅sinh (r)⋅cosh (r) + cos (φ)⋅sinh (r)⋅cosh (r)
────────────────────────────────────────────────────────────────────
                                                                    
                                                                    

 g4
⎛      2       ⎞     6   
⎝3⋅sinh (r) + 2⎠⋅sinh (r)

d0dag

com d[ 4 ], d[ 5 ]

Comutator is
[sinh(r)⋅b(1) + cosh(r)⋅b+(0)
,
                                                   -ⅈ⋅θ₀                        -ⅈ⋅θ₀                     
-ⅈ⋅sin(φ)⋅sinh(r)⋅b(3) - ⅈ⋅sin(φ)⋅cosh(r)⋅b+(2) + ℯ     ⋅cos(φ)⋅sinh(r)⋅b(0) + ℯ     ⋅cos(φ)⋅cosh(r)⋅b+(1)
]

 Which evaluates to:
0


com d[ 4 ], d[ 6 ]

Comutator is
[sinh(r)⋅b(1) + cosh(r)⋅b+(0)
,
                                                -ⅈ⋅θ₀                          -ⅈ⋅θ₀                     
cos(φ)⋅sinh(r)⋅b(3) + cos(φ)⋅cosh(r)⋅b+(2) - ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(r)⋅b(0) - ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(r)⋅b+(1)
]

 Which evaluates to:
0


com d[ 4 ], d[ 7 ]

Comutator is
[sinh(r)⋅b(1) + cosh(r)⋅b+(0)
,
sinh(r)⋅b(2) + cosh(r)⋅b+(3)
]

 Which evaluates to:
0


com d[ 4 ], d[ 3 ]

Comutator is
[sinh(r)⋅b(1) + cosh(r)⋅b+(0)
,
sinh(r)⋅b+(2) + cosh(r)⋅b(3)
]

 Which evaluates to:
0


com d[ 4 ], d[ 2 ]

Comutator is
[sinh(r)⋅b(1) + cosh(r)⋅b+(0)
,
   ⅈ⋅θ₀                           ⅈ⋅θ₀                                                                 
ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r)⋅b+(0) + ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(r)⋅b(1) + cos(φ)⋅sinh(r)⋅b+(3) + cos(φ)⋅cosh(r)⋅b(2)
]

 Which evaluates to:
0


com d[ 4 ], d[ 1 ]

Comutator is
[sinh(r)⋅b(1) + cosh(r)⋅b+(0)
,
 ⅈ⋅θ₀                         ⅈ⋅θ₀                                                                     
ℯ    ⋅cos(φ)⋅sinh(r)⋅b+(0) + ℯ    ⋅cos(φ)⋅cosh(r)⋅b(1) + ⅈ⋅sin(φ)⋅sinh(r)⋅b+(3) + ⅈ⋅sin(φ)⋅cosh(r)⋅b(2)
]

 Which evaluates to:
0


d1dag

com d[ 5 ], d[ 6 ]

Comutator is
[                                                   -ⅈ⋅θ₀                        -ⅈ⋅θ₀                     
-ⅈ⋅sin(φ)⋅sinh(r)⋅b(3) - ⅈ⋅sin(φ)⋅cosh(r)⋅b+(2) + ℯ     ⋅cos(φ)⋅sinh(r)⋅b(0) + ℯ     ⋅cos(φ)⋅cosh(r)⋅b+(1)
,
                                                -ⅈ⋅θ₀                          -ⅈ⋅θ₀                     
cos(φ)⋅sinh(r)⋅b(3) + cos(φ)⋅cosh(r)⋅b+(2) - ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(r)⋅b(0) - ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(r)⋅b+(1)
]

 Which evaluates to:
0


com d[ 5 ], d[ 7 ]

Comutator is
[                                                   -ⅈ⋅θ₀                        -ⅈ⋅θ₀                     
-ⅈ⋅sin(φ)⋅sinh(r)⋅b(3) - ⅈ⋅sin(φ)⋅cosh(r)⋅b+(2) + ℯ     ⋅cos(φ)⋅sinh(r)⋅b(0) + ℯ     ⋅cos(φ)⋅cosh(r)⋅b+(1)
,
sinh(r)⋅b(2) + cosh(r)⋅b+(3)
]

 Which evaluates to:
0


com d[ 5 ], d[ 3 ]

Comutator is
[                                                   -ⅈ⋅θ₀                        -ⅈ⋅θ₀                     
-ⅈ⋅sin(φ)⋅sinh(r)⋅b(3) - ⅈ⋅sin(φ)⋅cosh(r)⋅b+(2) + ℯ     ⋅cos(φ)⋅sinh(r)⋅b(0) + ℯ     ⋅cos(φ)⋅cosh(r)⋅b+(1)
,
sinh(r)⋅b+(2) + cosh(r)⋅b(3)
]

 Which evaluates to:
0


com d[ 5 ], d[ 2 ]

Comutator is
[                                                   -ⅈ⋅θ₀                        -ⅈ⋅θ₀                     
-ⅈ⋅sin(φ)⋅sinh(r)⋅b(3) - ⅈ⋅sin(φ)⋅cosh(r)⋅b+(2) + ℯ     ⋅cos(φ)⋅sinh(r)⋅b(0) + ℯ     ⋅cos(φ)⋅cosh(r)⋅b+(1)
,
   ⅈ⋅θ₀                           ⅈ⋅θ₀                                                                 
ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r)⋅b+(0) + ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(r)⋅b(1) + cos(φ)⋅sinh(r)⋅b+(3) + cos(φ)⋅cosh(r)⋅b(2)
]

 Which evaluates to:
0


d2dag

com d[ 6 ], d[ 7 ]

Comutator is
[                                                -ⅈ⋅θ₀                          -ⅈ⋅θ₀                     
cos(φ)⋅sinh(r)⋅b(3) + cos(φ)⋅cosh(r)⋅b+(2) - ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(r)⋅b(0) - ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(r)⋅b+(1)
,
sinh(r)⋅b(2) + cosh(r)⋅b+(3)
]

 Which evaluates to:
0


com d[ 6 ], d[ 3 ]

Comutator is
[                                                -ⅈ⋅θ₀                          -ⅈ⋅θ₀                     
cos(φ)⋅sinh(r)⋅b(3) + cos(φ)⋅cosh(r)⋅b+(2) - ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(r)⋅b(0) - ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(r)⋅b+(1)
,
sinh(r)⋅b+(2) + cosh(r)⋅b(3)
]

 Which evaluates to:
0

[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

d 3 dagd 3

    2                                                                               2              
sinh (r)⋅b(2)⋅b+(2) + sinh(r)⋅cosh(r)⋅b(2)⋅b(3) + sinh(r)⋅cosh(r)⋅b+(3)⋅b+(2) + cosh (r)⋅b+(3)⋅b(3)

d 2 dagd 2

   ⅈ⋅θ₀                   2                    ⅈ⋅θ₀                                              ⅈ⋅θ₀                                                ⅈ⋅θ₀                   2                    2        2      
ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh (r)⋅b(3)⋅b+(0) + ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b(3)⋅b(1) + ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b+(2)⋅b+(0) + ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅cosh (r)⋅b+(2)⋅b(1) + sin (φ)⋅sinh (r)⋅b(

              2                                   2                                     2        2                    2        2                    2                                   2                        
0)⋅b+(0) + sin (φ)⋅sinh(r)⋅cosh(r)⋅b(0)⋅b(1) + sin (φ)⋅sinh(r)⋅cosh(r)⋅b+(1)⋅b+(0) + sin (φ)⋅cosh (r)⋅b+(1)⋅b(1) + cos (φ)⋅sinh (r)⋅b(3)⋅b+(3) + cos (φ)⋅sinh(r)⋅cosh(r)⋅b(3)⋅b(2) + cos (φ)⋅sinh(r)⋅cosh(r)⋅b+(2

             2        2                    -ⅈ⋅θ₀                   2                    -ⅈ⋅θ₀                                              -ⅈ⋅θ₀                                                -ⅈ⋅θ₀            
)⋅b+(3) + cos (φ)⋅cosh (r)⋅b+(2)⋅b(2) - ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh (r)⋅b(0)⋅b+(3) - ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b(0)⋅b(2) - ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b+(1)⋅b+(3) - ⅈ⋅ℯ     ⋅sin(φ)⋅cos(

       2              
φ)⋅cosh (r)⋅b+(1)⋅b(2)

d 1 dagd 1

     ⅈ⋅θ₀                   2                    ⅈ⋅θ₀                                              ⅈ⋅θ₀                                                ⅈ⋅θ₀                   2                    2        2    
- ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh (r)⋅b(3)⋅b+(0) - ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b(3)⋅b(1) - ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b+(2)⋅b+(0) - ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅cosh (r)⋅b+(2)⋅b(1) + sin (φ)⋅sinh (r)⋅

                2                                   2                                     2        2                    2        2                    2                                   2                      
b(3)⋅b+(3) + sin (φ)⋅sinh(r)⋅cosh(r)⋅b(3)⋅b(2) + sin (φ)⋅sinh(r)⋅cosh(r)⋅b+(2)⋅b+(3) + sin (φ)⋅cosh (r)⋅b+(2)⋅b(2) + cos (φ)⋅sinh (r)⋅b(0)⋅b+(0) + cos (φ)⋅sinh(r)⋅cosh(r)⋅b(0)⋅b(1) + cos (φ)⋅sinh(r)⋅cosh(r)⋅b+

               2        2                    -ⅈ⋅θ₀                   2                    -ⅈ⋅θ₀                                              -ⅈ⋅θ₀                                                -ⅈ⋅θ₀          
(1)⋅b+(0) + cos (φ)⋅cosh (r)⋅b+(1)⋅b(1) + ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh (r)⋅b(0)⋅b+(3) + ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b(0)⋅b(2) + ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b+(1)⋅b+(3) + ⅈ⋅ℯ     ⋅sin(φ)⋅co

         2              
s(φ)⋅cosh (r)⋅b+(1)⋅b(2)

d 0 dagd 0

    2                                                                               2              
sinh (r)⋅b(1)⋅b+(1) + sinh(r)⋅cosh(r)⋅b(1)⋅b(0) + sinh(r)⋅cosh(r)⋅b+(0)⋅b+(1) + cosh (r)⋅b+(0)⋅b(0)


 g4 expr=
⎛    2                                                                               2              ⎞ ⎛   ⅈ⋅θ₀                   2                    ⅈ⋅θ₀                                              ⅈ⋅θ₀     
⎝sinh (r)⋅b(2)⋅b+(2) + sinh(r)⋅cosh(r)⋅b(2)⋅b(3) + sinh(r)⋅cosh(r)⋅b+(3)⋅b+(2) + cosh (r)⋅b+(3)⋅b(3)⎠⋅⎝ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh (r)⋅b(3)⋅b+(0) + ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b(3)⋅b(1) + ⅈ⋅ℯ    ⋅sin(

                                           ⅈ⋅θ₀                   2                    2        2                    2                                   2                                     2        2        
φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b+(2)⋅b+(0) + ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅cosh (r)⋅b+(2)⋅b(1) + sin (φ)⋅sinh (r)⋅b(0)⋅b+(0) + sin (φ)⋅sinh(r)⋅cosh(r)⋅b(0)⋅b(1) + sin (φ)⋅sinh(r)⋅cosh(r)⋅b+(1)⋅b+(0) + sin (φ)⋅cosh (r)⋅b+(1

            2        2                    2                                   2                                     2        2                    -ⅈ⋅θ₀                   2                    -ⅈ⋅θ₀             
)⋅b(1) + cos (φ)⋅sinh (r)⋅b(3)⋅b+(3) + cos (φ)⋅sinh(r)⋅cosh(r)⋅b(3)⋅b(2) + cos (φ)⋅sinh(r)⋅cosh(r)⋅b+(2)⋅b+(3) + cos (φ)⋅cosh (r)⋅b+(2)⋅b(2) - ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh (r)⋅b(0)⋅b+(3) - ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ

                                 -ⅈ⋅θ₀                                                -ⅈ⋅θ₀                   2              ⎞ ⎛     ⅈ⋅θ₀                   2                    ⅈ⋅θ₀                            
)⋅sinh(r)⋅cosh(r)⋅b(0)⋅b(2) - ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b+(1)⋅b+(3) - ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅cosh (r)⋅b+(1)⋅b(2)⎠⋅⎝- ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh (r)⋅b(3)⋅b+(0) - ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(

                  ⅈ⋅θ₀                                                ⅈ⋅θ₀                   2                    2        2                    2                                   2                            
r)⋅b(3)⋅b(1) - ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b+(2)⋅b+(0) - ⅈ⋅ℯ    ⋅sin(φ)⋅cos(φ)⋅cosh (r)⋅b+(2)⋅b(1) + sin (φ)⋅sinh (r)⋅b(3)⋅b+(3) + sin (φ)⋅sinh(r)⋅cosh(r)⋅b(3)⋅b(2) + sin (φ)⋅sinh(r)⋅cosh(r)⋅b+(2)⋅b+

         2        2                    2        2                    2                                   2                                     2        2                    -ⅈ⋅θ₀                   2           
(3) + sin (φ)⋅cosh (r)⋅b+(2)⋅b(2) + cos (φ)⋅sinh (r)⋅b(0)⋅b+(0) + cos (φ)⋅sinh(r)⋅cosh(r)⋅b(0)⋅b(1) + cos (φ)⋅sinh(r)⋅cosh(r)⋅b+(1)⋅b+(0) + cos (φ)⋅cosh (r)⋅b+(1)⋅b(1) + ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh (r)⋅b(0)⋅b+

         -ⅈ⋅θ₀                                              -ⅈ⋅θ₀                                                -ⅈ⋅θ₀                   2              ⎞ ⎛    2                                                 
(3) + ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b(0)⋅b(2) + ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅sinh(r)⋅cosh(r)⋅b+(1)⋅b+(3) + ⅈ⋅ℯ     ⋅sin(φ)⋅cos(φ)⋅cosh (r)⋅b+(1)⋅b(2)⎠⋅⎝sinh (r)⋅b(1)⋅b+(1) + sinh(r)⋅cosh(r)⋅b(1)⋅b(0) + sinh

                              2              ⎞
(r)⋅cosh(r)⋅b+(0)⋅b+(1) + cosh (r)⋅b+(0)⋅b(0)⎠
