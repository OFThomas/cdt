Spatial modes = 4
Spectral modes = 1
Total dim = 4

 Two mode squeezing on modes,  0 , 1
Two mode squeezer on modes,  2 , 3
Phase shift on modes.  2 phase angle pi/2
Beamsplitter on modes,  1 , 2 angle=  pi/4

 mode transform

C matrix

⎡cosh(ξ)     0     0  0⎤
⎢                      ⎥
⎢   0     cosh(ξ)  0  0⎥
⎢                      ⎥
⎢   0        0     1  0⎥
⎢                      ⎥
⎣   0        0     0  1⎦

S matrix

⎡   0     sinh(ξ)  0  0⎤
⎢                      ⎥
⎢sinh(ξ)     0     0  0⎥
⎢                      ⎥
⎢   0        0     0  0⎥
⎢                      ⎥
⎣   0        0     0  0⎦


 mode transform

C matrix

⎡cosh(ξ)     0        0        0   ⎤
⎢                                  ⎥
⎢   0     cosh(ξ)     0        0   ⎥
⎢                                  ⎥
⎢   0        0     cosh(ξ)     0   ⎥
⎢                                  ⎥
⎣   0        0        0     cosh(ξ)⎦

S matrix

⎡   0     sinh(ξ)     0        0   ⎤
⎢                                  ⎥
⎢sinh(ξ)     0        0        0   ⎥
⎢                                  ⎥
⎢   0        0        0     sinh(ξ)⎥
⎢                                  ⎥
⎣   0        0     sinh(ξ)     0   ⎦


 mode transform

C matrix

⎡cosh(ξ)        0           0        0   ⎤
⎢                                        ⎥
⎢          ⅈ⋅θ₀                          ⎥
⎢   0     ℯ    ⋅cosh(ξ)     0        0   ⎥
⎢                                        ⎥
⎢   0           0        cosh(ξ)     0   ⎥
⎢                                        ⎥
⎣   0           0           0     cosh(ξ)⎦

S matrix

⎡      0        sinh(ξ)     0        0   ⎤
⎢                                        ⎥
⎢ ⅈ⋅θ₀                                   ⎥
⎢ℯ    ⋅sinh(ξ)     0        0        0   ⎥
⎢                                        ⎥
⎢      0           0        0     sinh(ξ)⎥
⎢                                        ⎥
⎣      0           0     sinh(ξ)     0   ⎦


 mode transform

C matrix

⎡cosh(ξ)            0                    0             0   ⎤
⎢                                                          ⎥
⎢           ⅈ⋅θ₀                                           ⎥
⎢   0      ℯ    ⋅cos(φ)⋅cosh(ξ)   ⅈ⋅sin(φ)⋅cosh(ξ)     0   ⎥
⎢                                                          ⎥
⎢            ⅈ⋅θ₀                                          ⎥
⎢   0     ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)      0   ⎥
⎢                                                          ⎥
⎣   0               0                    0          cosh(ξ)⎦

S matrix

⎡          0             sinh(ξ)     0            0        ⎤
⎢                                                          ⎥
⎢  ⅈ⋅θ₀                                                    ⎥
⎢ ℯ    ⋅cos(φ)⋅sinh(ξ)      0        0     ⅈ⋅sin(φ)⋅sinh(ξ)⎥
⎢                                                          ⎥
⎢   ⅈ⋅θ₀                                                   ⎥
⎢ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(ξ)     0        0      cos(φ)⋅sinh(ξ) ⎥
⎢                                                          ⎥
⎣          0                0     sinh(ξ)         0        ⎦


C matrix

⎡cosh(ξ)            0                    0             0   ⎤
⎢                                                          ⎥
⎢           ⅈ⋅θ₀                                           ⎥
⎢   0      ℯ    ⋅cos(φ)⋅cosh(ξ)   ⅈ⋅sin(φ)⋅cosh(ξ)     0   ⎥
⎢                                                          ⎥
⎢            ⅈ⋅θ₀                                          ⎥
⎢   0     ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)      0   ⎥
⎢                                                          ⎥
⎣   0               0                    0          cosh(ξ)⎦

S matrix

⎡          0             sinh(ξ)     0            0        ⎤
⎢                                                          ⎥
⎢  ⅈ⋅θ₀                                                    ⎥
⎢ ℯ    ⋅cos(φ)⋅sinh(ξ)      0        0     ⅈ⋅sin(φ)⋅sinh(ξ)⎥
⎢                                                          ⎥
⎢   ⅈ⋅θ₀                                                   ⎥
⎢ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(ξ)     0        0      cos(φ)⋅sinh(ξ) ⎥
⎢                                                          ⎥
⎣          0                0     sinh(ξ)         0        ⎦

rel
            ⎡        cosh(ξ)                     0                    0                  0            
            ⎢                                                                                         
⎡⎡b(0)⎤ ⎤   ⎢                            ⅈ⋅θ₀                                                         
⎢⎢    ⎥ ⎥   ⎢           0               ℯ    ⋅cos(φ)⋅cosh(ξ)   ⅈ⋅sin(φ)⋅cosh(ξ)          0           ℯ
⎢⎢b(1)⎥ ⎥   ⎢                                                                                         
⎢⎢    ⎥ ⎥   ⎢                             ⅈ⋅θ₀                                                        
⎢⎢b(2)⎥ ⎥   ⎢           0              ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0          ⅈ⋅
⎢⎢    ⎥ ⎥   ⎢                                                                                         
⎢⎣b(3)⎦ ⎥   ⎢           0                        0                    0               cosh(ξ)         
⎢       ⎥ = ⎢                                                                                         
⎢⎡b+(0)⎤⎥   ⎢           0                     sinh(ξ)                 0                  0            
⎢⎢     ⎥⎥   ⎢                                                                                         
⎢⎢b+(1)⎥⎥   ⎢  -ⅈ⋅θ₀                                                                                  
⎢⎢     ⎥⎥   ⎢ ℯ     ⋅cos(φ)⋅sinh(ξ)              0                    0          -ⅈ⋅sin(φ)⋅sinh(ξ)    
⎢⎢b+(2)⎥⎥   ⎢                                                                                         
⎢⎢     ⎥⎥   ⎢    -ⅈ⋅θ₀                                                                                
⎣⎣b+(3)⎦⎦   ⎢-ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(ξ)            0                    0           cos(φ)⋅sinh(ξ)      
            ⎢                                                                                         
            ⎣           0                        0                 sinh(ξ)               0            

        0                     sinh(ξ)                   0                 0        ⎤          
                                                                                   ⎥          
ⅈ⋅θ₀                                                                               ⎥ ⎡⎡b(0)⎤ ⎤
    ⋅cos(φ)⋅sinh(ξ)              0                      0          ⅈ⋅sin(φ)⋅sinh(ξ)⎥ ⎢⎢    ⎥ ⎥
                                                                                   ⎥ ⎢⎢b(1)⎥ ⎥
 ⅈ⋅θ₀                                                                              ⎥ ⎢⎢    ⎥ ⎥
ℯ    ⋅sin(φ)⋅sinh(ξ)             0                      0           cos(φ)⋅sinh(ξ) ⎥ ⎢⎢b(2)⎥ ⎥
                                                                                   ⎥ ⎢⎢    ⎥ ⎥
        0                        0                   sinh(ξ)              0        ⎥ ⎢⎣b(3)⎦ ⎥
                                                                                   ⎥⋅⎢       ⎥
     cosh(ξ)                     0                      0                 0        ⎥ ⎢⎡b+(0)⎤⎥
                                                                                   ⎥ ⎢⎢     ⎥⎥
                        -ⅈ⋅θ₀                                                      ⎥ ⎢⎢b+(1)⎥⎥
        0              ℯ     ⋅cos(φ)⋅cosh(ξ)    -ⅈ⋅sin(φ)⋅cosh(ξ)         0        ⎥ ⎢⎢     ⎥⎥
                                                                                   ⎥ ⎢⎢b+(2)⎥⎥
                          -ⅈ⋅θ₀                                                    ⎥ ⎢⎢     ⎥⎥
        0             -ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0        ⎥ ⎣⎣b+(3)⎦⎦
                                                                                   ⎥          
        0                        0                      0              cosh(ξ)     ⎦          
n 8
          ⎡        cosh(ξ)                     0                    0                  0              
          ⎢                                                                                           
⎡b(0) ⎤   ⎢                            ⅈ⋅θ₀                                                         ⅈ⋅
⎢     ⎥   ⎢           0               ℯ    ⋅cos(φ)⋅cosh(ξ)   ⅈ⋅sin(φ)⋅cosh(ξ)          0           ℯ  
⎢b(1) ⎥   ⎢                                                                                           
⎢     ⎥   ⎢                             ⅈ⋅θ₀                                                         ⅈ
⎢b(2) ⎥   ⎢           0              ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0          ⅈ⋅ℯ 
⎢     ⎥   ⎢                                                                                           
⎢b(3) ⎥   ⎢           0                        0                    0               cosh(ξ)           
⎢     ⎥ = ⎢                                                                                           
⎢b+(0)⎥   ⎢           0                     sinh(ξ)                 0                  0              
⎢     ⎥   ⎢                                                                                           
⎢b+(1)⎥   ⎢  -ⅈ⋅θ₀                                                                                    
⎢     ⎥   ⎢ ℯ     ⋅cos(φ)⋅sinh(ξ)              0                    0          -ⅈ⋅sin(φ)⋅sinh(ξ)      
⎢b+(2)⎥   ⎢                                                                                           
⎢     ⎥   ⎢    -ⅈ⋅θ₀                                                                                  
⎣b+(3)⎦   ⎢-ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(ξ)            0                    0           cos(φ)⋅sinh(ξ)        
          ⎢                                                                                           
          ⎣           0                        0                 sinh(ξ)               0              

      0                     sinh(ξ)                   0                 0        ⎤                
                                                                                 ⎥                
θ₀                                                                               ⎥ ⎡⎡b(0)⎤ ⎤      
  ⋅cos(φ)⋅sinh(ξ)              0                      0          ⅈ⋅sin(φ)⋅sinh(ξ)⎥ ⎢⎢    ⎥ ⎥      
                                                                                 ⎥ ⎢⎢b(1)⎥ ⎥      
⋅θ₀                                                                              ⎥ ⎢⎢    ⎥ ⎥      
   ⋅sin(φ)⋅sinh(ξ)             0                      0           cos(φ)⋅sinh(ξ) ⎥ ⎢⎢b(2)⎥ ⎥      
                                                                                 ⎥ ⎢⎢    ⎥ ⎥      
      0                        0                   sinh(ξ)              0        ⎥ ⎢⎣b(3)⎦ ⎥      
                                                                                 ⎥⋅⎢       ⎥[:8, ]
   cosh(ξ)                     0                      0                 0        ⎥ ⎢⎡b+(0)⎤⎥      
                                                                                 ⎥ ⎢⎢     ⎥⎥      
                      -ⅈ⋅θ₀                                                      ⎥ ⎢⎢b+(1)⎥⎥      
      0              ℯ     ⋅cos(φ)⋅cosh(ξ)    -ⅈ⋅sin(φ)⋅cosh(ξ)         0        ⎥ ⎢⎢     ⎥⎥      
                                                                                 ⎥ ⎢⎢b+(2)⎥⎥      
                        -ⅈ⋅θ₀                                                    ⎥ ⎢⎢     ⎥⎥      
      0             -ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0        ⎥ ⎣⎣b+(3)⎦⎦      
                                                                                 ⎥                
      0                        0                      0              cosh(ξ)     ⎦                














None
None
None
None
None
None
None
None




⎡        cosh(ξ)                     0                    0                  0                    0   
⎢                                                                                                     
⎢                            ⅈ⋅θ₀                                                         ⅈ⋅θ₀        
⎢           0               ℯ    ⋅cos(φ)⋅cosh(ξ)   ⅈ⋅sin(φ)⋅cosh(ξ)          0           ℯ    ⋅cos(φ)⋅
⎢                                                                                                     
⎢                             ⅈ⋅θ₀                                                         ⅈ⋅θ₀       
⎢           0              ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0          ⅈ⋅ℯ    ⋅sin(φ)
⎢                                                                                                     
⎢           0                        0                    0               cosh(ξ)                 0   
⎢                                                                                                     
⎢           0                     sinh(ξ)                 0                  0                 cosh(ξ)
⎢                                                                                                     
⎢  -ⅈ⋅θ₀                                                                                              
⎢ ℯ     ⋅cos(φ)⋅sinh(ξ)              0                    0          -ⅈ⋅sin(φ)⋅sinh(ξ)            0   
⎢                                                                                                     
⎢    -ⅈ⋅θ₀                                                                                            
⎢-ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(ξ)            0                    0           cos(φ)⋅sinh(ξ)              0   
⎢                                                                                                     
⎣           0                        0                 sinh(ξ)               0                    0   

                  sinh(ξ)                   0                 0        ⎤                
                                                                       ⎥                
                                                                       ⎥ ⎡⎡b(0)⎤ ⎤      
sinh(ξ)              0                      0          ⅈ⋅sin(φ)⋅sinh(ξ)⎥ ⎢⎢    ⎥ ⎥      
                                                                       ⎥ ⎢⎢b(1)⎥ ⎥      
                                                                       ⎥ ⎢⎢    ⎥ ⎥      
⋅sinh(ξ)             0                      0           cos(φ)⋅sinh(ξ) ⎥ ⎢⎢b(2)⎥ ⎥      
                                                                       ⎥ ⎢⎢    ⎥ ⎥      
                     0                   sinh(ξ)              0        ⎥ ⎢⎣b(3)⎦ ⎥      
                                                                       ⎥⋅⎢       ⎥[:8, ]
                     0                      0                 0        ⎥ ⎢⎡b+(0)⎤⎥      
                                                                       ⎥ ⎢⎢     ⎥⎥      
            -ⅈ⋅θ₀                                                      ⎥ ⎢⎢b+(1)⎥⎥      
           ℯ     ⋅cos(φ)⋅cosh(ξ)    -ⅈ⋅sin(φ)⋅cosh(ξ)         0        ⎥ ⎢⎢     ⎥⎥      
                                                                       ⎥ ⎢⎢b+(2)⎥⎥      
              -ⅈ⋅θ₀                                                    ⎥ ⎢⎢     ⎥⎥      
          -ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0        ⎥ ⎣⎣b+(3)⎦⎦      
                                                                       ⎥                
                     0                      0              cosh(ξ)     ⎦                

 g4
gamma
 ⅈ⋅θ₀    2        2        2   
ℯ    ⋅cos (φ)⋅sinh (ξ)⋅cosh (ξ)
gamma
0
gamma
  ⅈ⋅θ₀    2        2        2   
-ℯ    ⋅sin (φ)⋅sinh (ξ)⋅cosh (ξ)

 gamma 

   4        4        4           2       2        4        4         4        4        4   
sin (φ)⋅sinh (ξ)⋅cosh (ξ) - 2⋅sin (φ)⋅cos (φ)⋅sinh (ξ)⋅cosh (ξ) + cos (φ)⋅sinh (ξ)⋅cosh (ξ)

BBdag diag terms

                                     2         
⎛   2        2         2        2   ⎞      4   
⎝sin (φ)⋅sinh (ξ) + cos (φ)⋅sinh (ξ)⎠ ⋅sinh (ξ)
g4 not normalised
                                     2                                                                
⎛   2        2         2        2   ⎞      4        ⎛   2        2         2        2   ⎞    2        
⎝sin (φ)⋅sinh (ξ) + cos (φ)⋅sinh (ξ)⎠ ⋅sinh (ξ) + 2⋅⎝sin (φ)⋅sinh (ξ) + cos (φ)⋅sinh (ξ)⎠⋅sin (φ)⋅sinh

                                                                                                      
4        2        ⎛   2        2         2        2   ⎞    2        4        2         4        4     
 (ξ)⋅cosh (ξ) + 2⋅⎝sin (φ)⋅sinh (ξ) + cos (φ)⋅sinh (ξ)⎠⋅cos (φ)⋅sinh (ξ)⋅cosh (ξ) + sin (φ)⋅sinh (ξ)⋅c

                                                                         
   4           2       2        4        4         4        4        4   
osh (ξ) - 2⋅sin (φ)⋅cos (φ)⋅sinh (ξ)⋅cosh (ξ) + cos (φ)⋅sinh (ξ)⋅cosh (ξ)
                                     2                                                                
⎛   2        2         2        2   ⎞      4        ⎛   2        2         2        2   ⎞    2        
⎝sin (φ)⋅sinh (ξ) + cos (φ)⋅sinh (ξ)⎠ ⋅sinh (ξ) + 2⋅⎝sin (φ)⋅sinh (ξ) + cos (φ)⋅sinh (ξ)⎠⋅sin (φ)⋅sinh

                                                                                                      
4        2        ⎛   2        2         2        2   ⎞    2        4        2         4        4     
 (ξ)⋅cosh (ξ) + 2⋅⎝sin (φ)⋅sinh (ξ) + cos (φ)⋅sinh (ξ)⎠⋅cos (φ)⋅sinh (ξ)⋅cosh (ξ) + sin (φ)⋅sinh (ξ)⋅c

                                                                         
   4           2       2        4        4         4        4        4   
osh (ξ) - 2⋅sin (φ)⋅cos (φ)⋅sinh (ξ)⋅cosh (ξ) + cos (φ)⋅sinh (ξ)⋅cosh (ξ)
g4calc in opalg
full transform subs
⎡        cosh(ξ)                     0                    0                  0                    0   
⎢                                                                                                     
⎢                            ⅈ⋅θ₀                                                         ⅈ⋅θ₀        
⎢           0               ℯ    ⋅cos(φ)⋅cosh(ξ)   ⅈ⋅sin(φ)⋅cosh(ξ)          0           ℯ    ⋅cos(φ)⋅
⎢                                                                                                     
⎢                             ⅈ⋅θ₀                                                         ⅈ⋅θ₀       
⎢           0              ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0          ⅈ⋅ℯ    ⋅sin(φ)
⎢                                                                                                     
⎢           0                        0                    0               cosh(ξ)                 0   
⎢                                                                                                     
⎢           0                     sinh(ξ)                 0                  0                 cosh(ξ)
⎢                                                                                                     
⎢  -ⅈ⋅θ₀                                                                                              
⎢ ℯ     ⋅cos(φ)⋅sinh(ξ)              0                    0          -ⅈ⋅sin(φ)⋅sinh(ξ)            0   
⎢                                                                                                     
⎢    -ⅈ⋅θ₀                                                                                            
⎢-ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(ξ)            0                    0           cos(φ)⋅sinh(ξ)              0   
⎢                                                                                                     
⎣           0                        0                 sinh(ξ)               0                    0   

                  sinh(ξ)                   0                 0        ⎤
                                                                       ⎥
                                                                       ⎥
sinh(ξ)              0                      0          ⅈ⋅sin(φ)⋅sinh(ξ)⎥
                                                                       ⎥
                                                                       ⎥
⋅sinh(ξ)             0                      0           cos(φ)⋅sinh(ξ) ⎥
                                                                       ⎥
                     0                   sinh(ξ)              0        ⎥
                                                                       ⎥
                     0                      0                 0        ⎥
                                                                       ⎥
            -ⅈ⋅θ₀                                                      ⎥
           ℯ     ⋅cos(φ)⋅cosh(ξ)    -ⅈ⋅sin(φ)⋅cosh(ξ)         0        ⎥
                                                                       ⎥
              -ⅈ⋅θ₀                                                    ⎥
          -ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0        ⎥
                                                                       ⎥
                     0                      0              cosh(ξ)     ⎦
phi=0
⎡        cosh(ξ)                     0                    0                  0                    0   
⎢                                                                                                     
⎢                            ⅈ⋅θ₀                                                         ⅈ⋅θ₀        
⎢           0               ℯ    ⋅cos(φ)⋅cosh(ξ)   ⅈ⋅sin(φ)⋅cosh(ξ)          0           ℯ    ⋅cos(φ)⋅
⎢                                                                                                     
⎢                             ⅈ⋅θ₀                                                         ⅈ⋅θ₀       
⎢           0              ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0          ⅈ⋅ℯ    ⋅sin(φ)
⎢                                                                                                     
⎢           0                        0                    0               cosh(ξ)                 0   
⎢                                                                                                     
⎢           0                     sinh(ξ)                 0                  0                 cosh(ξ)
⎢                                                                                                     
⎢  -ⅈ⋅θ₀                                                                                              
⎢ ℯ     ⋅cos(φ)⋅sinh(ξ)              0                    0          -ⅈ⋅sin(φ)⋅sinh(ξ)            0   
⎢                                                                                                     
⎢    -ⅈ⋅θ₀                                                                                            
⎢-ⅈ⋅ℯ     ⋅sin(φ)⋅sinh(ξ)            0                    0           cos(φ)⋅sinh(ξ)              0   
⎢                                                                                                     
⎣           0                        0                 sinh(ξ)               0                    0   

                  sinh(ξ)                   0                 0        ⎤
                                                                       ⎥
                                                                       ⎥
sinh(ξ)              0                      0          ⅈ⋅sin(φ)⋅sinh(ξ)⎥
                                                                       ⎥
                                                                       ⎥
⋅sinh(ξ)             0                      0           cos(φ)⋅sinh(ξ) ⎥
                                                                       ⎥
                     0                   sinh(ξ)              0        ⎥
                                                                       ⎥
                     0                      0                 0        ⎥
                                                                       ⎥
            -ⅈ⋅θ₀                                                      ⎥
           ℯ     ⋅cos(φ)⋅cosh(ξ)    -ⅈ⋅sin(φ)⋅cosh(ξ)         0        ⎥
                                                                       ⎥
              -ⅈ⋅θ₀                                                    ⎥
          -ⅈ⋅ℯ     ⋅sin(φ)⋅cosh(ξ)   cos(φ)⋅cosh(ξ)           0        ⎥
                                                                       ⎥
                     0                      0              cosh(ξ)     ⎦
Factorised G4 normalised
⎛   2        2         2        2                          2         2        2         2        2   ⎞
⎝sin (φ)⋅sinh (ξ) + sin (φ)⋅cosh (ξ) - 2⋅sin(φ)⋅cos(φ)⋅cosh (ξ) + cos (φ)⋅sinh (ξ) + cos (φ)⋅cosh (ξ)⎠
──────────────────────────────────────────────────────────────────────────────────────────────────────
                                                                                                      
                                                                                            ⎛    2    
                                                                                            ⎝sinh (ξ) 

 ⎛   2        2         2        2                          2         2        2         2        2   
⋅⎝sin (φ)⋅sinh (ξ) + sin (φ)⋅cosh (ξ) + 2⋅sin(φ)⋅cos(φ)⋅cosh (ξ) + cos (φ)⋅sinh (ξ) + cos (φ)⋅cosh (ξ)
──────────────────────────────────────────────────────────────────────────────────────────────────────
           2                                                                                          
      2   ⎞                                                                                           
+ cosh (ξ)⎠                                                                                           

⎞
⎠
─
 
 
 
H
⎡0  0  0  F⎤
⎢          ⎥
⎢0  0  F  0⎥
⎢          ⎥
⎢   _      ⎥
⎢0  F  0  0⎥
⎢          ⎥
⎢_         ⎥
⎣F  0  0  0⎦
Grouping signal and idler terms,
⎡0  0  0  F⎤
⎢          ⎥
⎢0  0  F  0⎥
⎢          ⎥
⎢   _      ⎥
⎢0  F  0  0⎥
⎢          ⎥
⎢_         ⎥
⎣F  0  0  0⎦
⎡⎡0  0⎤  ⎡0  F⎤⎤
⎢⎢    ⎥  ⎢    ⎥⎥
⎢⎣0  0⎦  ⎣F  0⎦⎥
⎢              ⎥
⎢⎡   _⎤        ⎥
⎢⎢0  F⎥  ⎡0  0⎤⎥
⎢⎢    ⎥  ⎢    ⎥⎥
⎢⎢_   ⎥  ⎣0  0⎦⎥
⎣⎣F  0⎦        ⎦
type H <class 'sympy.matrices.dense.MutableDenseMatrix'>, type Ha <class 'sympy.matrices.expressions.blockmatrix.BlockMatrix'>
block matrix
arg=
⎡ 0    0    0    -ⅈ⋅F⎤
⎢                    ⎥
⎢ 0    0   -ⅈ⋅F   0  ⎥
⎢                    ⎥
⎢       _            ⎥
⎢ 0   ⅈ⋅F   0     0  ⎥
⎢                    ⎥
⎢  _                 ⎥
⎣ⅈ⋅F   0    0     0  ⎦
⎡               _____        _____                                                                    
⎢              ╱   _        ╱   _                                                                     
⎢            ╲╱  F⋅F     -╲╱  F⋅F                                                                     
⎢           ℯ           ℯ                                                                             
⎢           ───────── + ──────────                                  0                                 
⎢               2           2                                                                         
⎢                                                                                                     
⎢                                                                                                     
⎢                                                                                                     
⎢                                                             _____        _____                      
⎢                                                            ╱   _        ╱   _                       
⎢                                                          ╲╱  F⋅F     -╲╱  F⋅F                     ╲╱
⎢                                                         ℯ           ℯ                        ⅈ⋅F⋅ℯ  
⎢                     0                                   ───────── + ──────────             - ───────
⎢                                                             2           2                           
⎢                                                                                                    ╱
⎢                                                                                                2⋅╲╱ 
⎢                                                                                                     
⎢                                                             _____                   _____           
⎢                                                   _____    ╱   _         _____     ╱   _           ╱
⎢                                                  ╱   _   ╲╱  F⋅F        ╱   _   -╲╱  F⋅F         ╲╱ 
⎢                                              ⅈ⋅╲╱  F⋅F ⋅ℯ           ⅈ⋅╲╱  F⋅F ⋅ℯ                ℯ   
⎢                     0                        ──────────────────── - ─────────────────────       ────
⎢                                                      2⋅F                     2⋅F                    
⎢                                                                                                     
⎢               _____                   _____                                                         
⎢     _____    ╱   _         _____     ╱   _                                                          
⎢    ╱   _   ╲╱  F⋅F        ╱   _   -╲╱  F⋅F                                                          
⎢ⅈ⋅╲╱  F⋅F ⋅ℯ           ⅈ⋅╲╱  F⋅F ⋅ℯ                                                                  
⎢──────────────────── - ─────────────────────                       0                                 
⎣        2⋅F                     2⋅F                                                                  

                                   _____            _____⎤
                                  ╱   _            ╱   _ ⎥
                                ╲╱  F⋅F         -╲╱  F⋅F ⎥
                           ⅈ⋅F⋅ℯ           ⅈ⋅F⋅ℯ         ⎥
      0                  - ───────────── + ──────────────⎥
                                  _____           _____  ⎥
                                 ╱   _           ╱   _   ⎥
                             2⋅╲╱  F⋅F       2⋅╲╱  F⋅F   ⎥
                                                         ⎥
 _____            _____                                  ⎥
╱   _            ╱   _                                   ⎥
  F⋅F         -╲╱  F⋅F                                   ⎥
         ⅈ⋅F⋅ℯ                                           ⎥
────── + ──────────────                 0                ⎥
_____           _____                                    ⎥
   _           ╱   _                                     ⎥
 F⋅F       2⋅╲╱  F⋅F                                     ⎥
                                                         ⎥
_____        _____                                       ⎥
   _        ╱   _                                        ⎥
 F⋅F     -╲╱  F⋅F                                        ⎥
        ℯ                                                ⎥
───── + ──────────                      0                ⎥
2           2                                            ⎥
                                                         ⎥
                                  _____        _____     ⎥
                                 ╱   _        ╱   _      ⎥
                               ╲╱  F⋅F     -╲╱  F⋅F      ⎥
                              ℯ           ℯ              ⎥
      0                       ───────── + ──────────     ⎥
                                  2           2          ⎦
⎡                                                                                     ⎛   _____⎞ ⎤
⎢         ⎛   _____⎞                                                                  ⎜  ╱   _ ⎟ ⎥
⎢         ⎜  ╱   _ ⎟                                                         -ⅈ⋅F⋅sinh⎝╲╱  F⋅F ⎠ ⎥
⎢     cosh⎝╲╱  F⋅F ⎠                    0                       0            ────────────────────⎥
⎢                                                                                     _____      ⎥
⎢                                                                                    ╱   _       ⎥
⎢                                                                                  ╲╱  F⋅F       ⎥
⎢                                                                                                ⎥
⎢                                                               ⎛   _____⎞                       ⎥
⎢                                    ⎛   _____⎞                 ⎜  ╱   _ ⎟                       ⎥
⎢                                    ⎜  ╱   _ ⎟        -ⅈ⋅F⋅sinh⎝╲╱  F⋅F ⎠                       ⎥
⎢            0                   cosh⎝╲╱  F⋅F ⎠        ────────────────────           0          ⎥
⎢                                                               _____                            ⎥
⎢                                                              ╱   _                             ⎥
⎢                                                            ╲╱  F⋅F                             ⎥
⎢                                                                                                ⎥
⎢                                _____     ⎛   _____⎞                                            ⎥
⎢                               ╱   _      ⎜  ╱   _ ⎟         ⎛   _____⎞                         ⎥
⎢                           ⅈ⋅╲╱  F⋅F ⋅sinh⎝╲╱  F⋅F ⎠         ⎜  ╱   _ ⎟                         ⎥
⎢            0              ─────────────────────────     cosh⎝╲╱  F⋅F ⎠              0          ⎥
⎢                                       F                                                        ⎥
⎢                                                                                                ⎥
⎢     _____     ⎛   _____⎞                                                                       ⎥
⎢    ╱   _      ⎜  ╱   _ ⎟                                                          ⎛   _____⎞   ⎥
⎢ⅈ⋅╲╱  F⋅F ⋅sinh⎝╲╱  F⋅F ⎠                                                          ⎜  ╱   _ ⎟   ⎥
⎢─────────────────────────              0                       0               cosh⎝╲╱  F⋅F ⎠   ⎥
⎣            F                                                                                   ⎦
⎡ cosh(13)       0            0       -ⅈ⋅sinh(13)⎤
⎢                                                ⎥
⎢    0        cosh(13)   -ⅈ⋅sinh(13)       0     ⎥
⎢                                                ⎥
⎢    0       ⅈ⋅sinh(13)   cosh(13)         0     ⎥
⎢                                                ⎥
⎣ⅈ⋅sinh(13)      0            0        cosh(13)  ⎦

void M_matrix::F_update(){
_F(0, 0) = cosh(13);
_F(1, 0) = 0;
_F(2, 0) = 0;
_F(3, 0) = I*sinh(13);
_F(0, 1) = 0;
_F(1, 1) = cosh(13);
_F(2, 1) = I*sinh(13);
_F(3, 1) = 0;
_F(0, 2) = 0;
_F(1, 2) = -I*sinh(13);
_F(2, 2) = cosh(13);
_F(3, 2) = 0;
_F(0, 3) = -I*sinh(13);
_F(1, 3) = 0;
_F(2, 3) = 0;
_F(3, 3) = cosh(13);
};
[         221206.69600559                       0.0                       0.0  (0.0 - 221206.69600333j
[                     0.0           221206.69600559  (0.0 - 221206.69600333j)                       0.
[                     0.0  (0.0 + 221206.69600333j)           221206.69600559                       0.
[(0.0 + 221206.69600333j)                       0.0                       0.0           221206.6960055

)]
0]
0]
9]
221206.69600559
0.0
0.0
(0.0 + 221206.69600333j)
0.0
221206.69600559
(0.0 + 221206.69600333j)
0.0
0.0
(0.0 - 221206.69600333j)
221206.69600559
0.0
(0.0 - 221206.69600333j)
0.0
0.0
221206.69600559
