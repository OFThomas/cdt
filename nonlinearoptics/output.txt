Spatial modes = 4
Spectral modes = 1
Total dim = 4

 Two mode squeezing on modes,  0 , 1
Two mode squeezer on modes,  2 , 3
Phase shift on modes.  2 phase angle pi/2
Beamsplitter on modes,  1 , 2 angle=  pi/4
⎡cosh(1)     0     0  0     0     sinh(1)  0  0⎤
⎢                                              ⎥
⎢   0     cosh(2)  0  0  sinh(2)     0     0  0⎥
⎢                                              ⎥
⎢   0        0     1  0     0        0     0  0⎥
⎢                                              ⎥
⎢   0        0     0  1     0        0     0  0⎥
⎢                                              ⎥
⎢   0     sinh(1)  0  0  cosh(1)     0     0  0⎥
⎢                                              ⎥
⎢sinh(2)     0     0  0     0     cosh(2)  0  0⎥
⎢                                              ⎥
⎢   0        0     0  0     0        0     1  0⎥
⎢                                              ⎥
⎣   0        0     0  0     0        0     0  1⎦
⎡1  0     0        0     0  0     0        0   ⎤
⎢                                              ⎥
⎢0  1     0        0     0  0     0        0   ⎥
⎢                                              ⎥
⎢0  0  cosh(1)     0     0  0     0     sinh(1)⎥
⎢                                              ⎥
⎢0  0     0     cosh(2)  0  0  sinh(2)     0   ⎥
⎢                                              ⎥
⎢0  0     0        0     1  0     0        0   ⎥
⎢                                              ⎥
⎢0  0     0        0     0  1     0        0   ⎥
⎢                                              ⎥
⎢0  0     0     sinh(1)  0  0  cosh(1)     0   ⎥
⎢                                              ⎥
⎣0  0  sinh(2)     0     0  0     0     cosh(2)⎦
⎡1  0  0  0  0  0  0   0⎤
⎢                       ⎥
⎢0  1  0  0  0  0  0   0⎥
⎢                       ⎥
⎢0  0  ⅈ  0  0  0  0   0⎥
⎢                       ⎥
⎢0  0  0  1  0  0  0   0⎥
⎢                       ⎥
⎢0  0  0  0  1  0  0   0⎥
⎢                       ⎥
⎢0  0  0  0  0  1  0   0⎥
⎢                       ⎥
⎢0  0  0  0  0  0  -ⅈ  0⎥
⎢                       ⎥
⎣0  0  0  0  0  0  0   1⎦
⎡1   0     0    0  0    0       0     0⎤
⎢                                      ⎥
⎢    √2   √2⋅ⅈ                         ⎥
⎢0   ──   ────  0  0    0       0     0⎥
⎢    2     2                           ⎥
⎢                                      ⎥
⎢   √2⋅ⅈ   √2                          ⎥
⎢0  ────   ──   0  0    0       0     0⎥
⎢    2     2                           ⎥
⎢                                      ⎥
⎢0   0     0    1  0    0       0     0⎥
⎢                                      ⎥
⎢0   0     0    0  1    0       0     0⎥
⎢                                      ⎥
⎢                       √2    -√2⋅ⅈ    ⎥
⎢0   0     0    0  0    ──    ──────  0⎥
⎢                       2       2      ⎥
⎢                                      ⎥
⎢                     -√2⋅ⅈ     √2     ⎥
⎢0   0     0    0  0  ──────    ──    0⎥
⎢                       2       2      ⎥
⎢                                      ⎥
⎣0   0     0    0  0    0       0     1⎦
        ⎡                                               ___                         ⎤
        ⎢                         a₀₀⋅cosh(1) + sinh(1)⋅a₁₀                         ⎥
        ⎢                                                                           ⎥
        ⎢                                                  ___              ___     ⎥
        ⎢     √2⋅a₁₀⋅cosh(2)   √2⋅a₂₀⋅cosh(1)   √2⋅sinh(2)⋅a₀₀   √2⋅sinh(1)⋅a₃₀     ⎥
        ⎢     ────────────── - ────────────── + ────────────── - ──────────────     ⎥
⎡a₀₀⎤   ⎢           2                2                2                2            ⎥
⎢   ⎥   ⎢                                                                           ⎥
⎢a₁₀⎥   ⎢                                                    ___                ___ ⎥
⎢   ⎥   ⎢ √2⋅ⅈ⋅a₁₀⋅cosh(2)   √2⋅ⅈ⋅a₂₀⋅cosh(1)   √2⋅ⅈ⋅sinh(2)⋅a₀₀   √2⋅ⅈ⋅sinh(1)⋅a₃₀ ⎥
⎢a₂₀⎥   ⎢ ──────────────── + ──────────────── + ──────────────── + ──────────────── ⎥
⎢   ⎥   ⎢        2                  2                  2                  2         ⎥
⎢a₃₀⎥   ⎢                                                                           ⎥
⎢   ⎥   ⎢                                               ___                         ⎥
⎢___⎥   ⎢                         a₃₀⋅cosh(2) + sinh(2)⋅a₂₀                         ⎥
⎢a₀₀⎥ = ⎢                                                                           ⎥
⎢   ⎥   ⎢                                               ___                         ⎥
⎢___⎥   ⎢                         a₁₀⋅sinh(1) + cosh(1)⋅a₀₀                         ⎥
⎢a₁₀⎥   ⎢                                                                           ⎥
⎢   ⎥   ⎢                                                  ___              ___     ⎥
⎢___⎥   ⎢     √2⋅a₀₀⋅sinh(2)   √2⋅a₃₀⋅sinh(1)   √2⋅cosh(2)⋅a₁₀   √2⋅cosh(1)⋅a₂₀     ⎥
⎢a₂₀⎥   ⎢     ────────────── - ────────────── + ────────────── - ──────────────     ⎥
⎢   ⎥   ⎢           2                2                2                2            ⎥
⎢___⎥   ⎢                                                                           ⎥
⎣a₃₀⎦   ⎢                                                     ___                ___⎥
        ⎢  √2⋅ⅈ⋅a₀₀⋅sinh(2)   √2⋅ⅈ⋅a₃₀⋅sinh(1)   √2⋅ⅈ⋅cosh(2)⋅a₁₀   √2⋅ⅈ⋅cosh(1)⋅a₂₀⎥
        ⎢- ──────────────── - ──────────────── - ──────────────── - ────────────────⎥
        ⎢         2                  2                  2                  2        ⎥
        ⎢                                                                           ⎥
        ⎢                                               ___                         ⎥
        ⎣                         a₂₀⋅sinh(2) + cosh(2)⋅a₃₀                         ⎦

 Numerics 

⎡cosh(1)     0     0  0     0     sinh(1)  0  0⎤
⎢                                              ⎥
⎢   0     cosh(2)  0  0  sinh(2)     0     0  0⎥
⎢                                              ⎥
⎢   0        0     1  0     0        0     0  0⎥
⎢                                              ⎥
⎢   0        0     0  1     0        0     0  0⎥
⎢                                              ⎥
⎢   0     sinh(1)  0  0  cosh(1)     0     0  0⎥
⎢                                              ⎥
⎢sinh(2)     0     0  0     0     cosh(2)  0  0⎥
⎢                                              ⎥
⎢   0        0     0  0     0        0     1  0⎥
⎢                                              ⎥
⎣   0        0     0  0     0        0     0  1⎦
⎡   0     sinh(1)⎤
⎢                ⎥
⎣sinh(2)     0   ⎦

 Squeeze matrix


numerical Svd

After svd doing u*s*v


Original sq matrix

6.21724893790088e-15

#############################################
#######        Close enough     #############
#############################################

⎡cosh(r₁)     0      0  0     0      sinh(r₁)  0  0⎤
⎢                                                  ⎥
⎢   0      cosh(r₂)  0  0  sinh(r₂)     0      0  0⎥
⎢                                                  ⎥
⎢   0         0      1  0     0         0      0  0⎥
⎢                                                  ⎥
⎢   0         0      0  1     0         0      0  0⎥
⎢                                                  ⎥
⎢              ⎛__⎞            ⎛__⎞                ⎥
⎢   0      sinh⎝r₁⎠  0  0  cosh⎝r₁⎠     0      0  0⎥
⎢                                                  ⎥
⎢    ⎛__⎞                                ⎛__⎞      ⎥
⎢sinh⎝r₂⎠     0      0  0     0      cosh⎝r₂⎠  0  0⎥
⎢                                                  ⎥
⎢   0         0      0  0     0         0      1  0⎥
⎢                                                  ⎥
⎣   0         0      0  0     0         0      0  1⎦
⎡1  0     0         0      0  0     0         0    ⎤
⎢                                                  ⎥
⎢0  1     0         0      0  0     0         0    ⎥
⎢                                                  ⎥
⎢0  0  cosh(r₅)     0      0  0     0      sinh(r₅)⎥
⎢                                                  ⎥
⎢0  0     0      cosh(r₆)  0  0  sinh(r₆)     0    ⎥
⎢                                                  ⎥
⎢0  0     0         0      1  0     0         0    ⎥
⎢                                                  ⎥
⎢0  0     0         0      0  1     0         0    ⎥
⎢                                                  ⎥
⎢                    ⎛__⎞            ⎛__⎞          ⎥
⎢0  0     0      sinh⎝r₅⎠  0  0  cosh⎝r₅⎠     0    ⎥
⎢                                                  ⎥
⎢          ⎛__⎞                                ⎛__⎞⎥
⎣0  0  sinh⎝r₆⎠     0      0  0     0      cosh⎝r₆⎠⎦
⎡1    0    0  0  0    0     0  0⎤
⎢                               ⎥
⎢    ⅈ⋅θ₀                       ⎥
⎢0  ℯ      0  0  0    0     0  0⎥
⎢                               ⎥
⎢0    0    1  0  0    0     0  0⎥
⎢                               ⎥
⎢0    0    0  1  0    0     0  0⎥
⎢                               ⎥
⎢0    0    0  0  1    0     0  0⎥
⎢                               ⎥
⎢                       __      ⎥
⎢                    -ⅈ⋅θ₀      ⎥
⎢0    0    0  0  0  ℯ       0  0⎥
⎢                               ⎥
⎢0    0    0  0  0    0     1  0⎥
⎢                               ⎥
⎣0    0    0  0  0    0     0  1⎦
⎡1     0         0      0  0      0          0      0⎤
⎢                                                    ⎥
⎢0   cos(φ)   ⅈ⋅sin(φ)  0  0      0          0      0⎥
⎢                                                    ⎥
⎢0  ⅈ⋅sin(φ)   cos(φ)   0  0      0          0      0⎥
⎢                                                    ⎥
⎢0     0         0      1  0      0          0      0⎥
⎢                                                    ⎥
⎢0     0         0      0  1      0          0      0⎥
⎢                                                    ⎥
⎢                                 ⎛_⎞          ⎛_⎞   ⎥
⎢0     0         0      0  0   cos⎝φ⎠    -ⅈ⋅sin⎝φ⎠  0⎥
⎢                                                    ⎥
⎢                                   ⎛_⎞      ⎛_⎞     ⎥
⎢0     0         0      0  0  -ⅈ⋅sin⎝φ⎠   cos⎝φ⎠    0⎥
⎢                                                    ⎥
⎣0     0         0      0  0      0          0      1⎦

C matrix

⎡cosh(r₁)     0      0  0⎤
⎢                        ⎥
⎢   0      cosh(r₂)  0  0⎥
⎢                        ⎥
⎢   0         0      1  0⎥
⎢                        ⎥
⎣   0         0      0  1⎦

S matrix

⎡   0      sinh(r₁)  0  0⎤
⎢                        ⎥
⎢sinh(r₂)     0      0  0⎥
⎢                        ⎥
⎢   0         0      0  0⎥
⎢                        ⎥
⎣   0         0      0  0⎦

 mode transform
        ⎡                        ___⎤
⎡a₀₀⎤   ⎢a₀₀⋅cosh(r₁) + sinh(r₁)⋅a₁₀⎥
⎢   ⎥   ⎢                           ⎥
⎢a₁₀⎥   ⎢                        ___⎥
⎢   ⎥ = ⎢a₁₀⋅cosh(r₂) + sinh(r₂)⋅a₀₀⎥
⎢a₂₀⎥   ⎢                           ⎥
⎢   ⎥   ⎢            a₂₀            ⎥
⎣a₃₀⎦   ⎢                           ⎥
        ⎣            a₃₀            ⎦


C matrix

⎡cosh(r₁)     0         0         0    ⎤
⎢                                      ⎥
⎢   0      cosh(r₂)     0         0    ⎥
⎢                                      ⎥
⎢   0         0      cosh(r₅)     0    ⎥
⎢                                      ⎥
⎣   0         0         0      cosh(r₆)⎦

S matrix

⎡   0      sinh(r₁)     0         0    ⎤
⎢                                      ⎥
⎢sinh(r₂)     0         0         0    ⎥
⎢                                      ⎥
⎢   0         0         0      sinh(r₅)⎥
⎢                                      ⎥
⎣   0         0      sinh(r₆)     0    ⎦

 mode transform
        ⎡                        ___⎤
        ⎢a₀₀⋅cosh(r₁) + sinh(r₁)⋅a₁₀⎥
⎡a₀₀⎤   ⎢                           ⎥
⎢   ⎥   ⎢                        ___⎥
⎢a₁₀⎥   ⎢a₁₀⋅cosh(r₂) + sinh(r₂)⋅a₀₀⎥
⎢   ⎥ = ⎢                           ⎥
⎢a₂₀⎥   ⎢                        ___⎥
⎢   ⎥   ⎢a₂₀⋅cosh(r₅) + sinh(r₅)⋅a₃₀⎥
⎣a₃₀⎦   ⎢                           ⎥
        ⎢                        ___⎥
        ⎣a₃₀⋅cosh(r₆) + sinh(r₆)⋅a₂₀⎦


C matrix

⎡cosh(r₁)        0            0         0    ⎤
⎢                                            ⎥
⎢           ⅈ⋅θ₀                             ⎥
⎢   0      ℯ    ⋅cosh(r₂)     0         0    ⎥
⎢                                            ⎥
⎢   0            0         cosh(r₅)     0    ⎥
⎢                                            ⎥
⎣   0            0            0      cosh(r₆)⎦

S matrix

⎡      0         sinh(r₁)     0         0    ⎤
⎢                                            ⎥
⎢ ⅈ⋅θ₀                                       ⎥
⎢ℯ    ⋅sinh(r₂)     0         0         0    ⎥
⎢                                            ⎥
⎢      0            0         0      sinh(r₅)⎥
⎢                                            ⎥
⎣      0            0      sinh(r₆)     0    ⎦

 mode transform
        ⎡                              ___      ⎤
        ⎢      a₀₀⋅cosh(r₁) + sinh(r₁)⋅a₁₀      ⎥
⎡a₀₀⎤   ⎢                                       ⎥
⎢   ⎥   ⎢     ⅈ⋅θ₀             ⅈ⋅θ₀          ___⎥
⎢a₁₀⎥   ⎢a₁₀⋅ℯ    ⋅cosh(r₂) + ℯ    ⋅sinh(r₂)⋅a₀₀⎥
⎢   ⎥ = ⎢                                       ⎥
⎢a₂₀⎥   ⎢                              ___      ⎥
⎢   ⎥   ⎢      a₂₀⋅cosh(r₅) + sinh(r₅)⋅a₃₀      ⎥
⎣a₃₀⎦   ⎢                                       ⎥
        ⎢                              ___      ⎥
        ⎣      a₃₀⋅cosh(r₆) + sinh(r₆)⋅a₂₀      ⎦


C matrix

⎡cosh(r₁)             0                     0             0    ⎤
⎢                                                              ⎥
⎢            ⅈ⋅θ₀                                              ⎥
⎢   0       ℯ    ⋅cos(φ)⋅cosh(r₂)   ⅈ⋅sin(φ)⋅cosh(r₅)     0    ⎥
⎢                                                              ⎥
⎢             ⅈ⋅θ₀                                             ⎥
⎢   0      ⅈ⋅ℯ    ⋅sin(φ)⋅cosh(r₂)   cos(φ)⋅cosh(r₅)      0    ⎥
⎢                                                              ⎥
⎣   0                 0                     0          cosh(r₆)⎦

S matrix

⎡           0             sinh(r₁)     0              0        ⎤
⎢                                                              ⎥
⎢  ⅈ⋅θ₀                                                        ⎥
⎢ ℯ    ⋅cos(φ)⋅sinh(r₂)      0         0      ⅈ⋅sin(φ)⋅sinh(r₅)⎥
⎢                                                              ⎥
⎢   ⅈ⋅θ₀                                                       ⎥
⎢ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r₂)     0         0       cos(φ)⋅sinh(r₅) ⎥
⎢                                                              ⎥
⎣           0                0      sinh(r₆)          0        ⎦

 mode transform
        ⎡                                                             ___                             
        ⎢                                     a₀₀⋅cosh(r₁) + sinh(r₁)⋅a₁₀                             
⎡a₀₀⎤   ⎢                                                                                             
⎢   ⎥   ⎢     ⅈ⋅θ₀                                            ⅈ⋅θ₀                 ___                
⎢a₁₀⎥   ⎢a₁₀⋅ℯ    ⋅cos(φ)⋅cosh(r₂) + ⅈ⋅a₂₀⋅sin(φ)⋅cosh(r₅) + ℯ    ⋅cos(φ)⋅sinh(r₂)⋅a₀₀ + ⅈ⋅sin(φ)⋅sinh
⎢   ⎥ = ⎢                                                                                             
⎢a₂₀⎥   ⎢       ⅈ⋅θ₀                                            ⅈ⋅θ₀                 ___              
⎢   ⎥   ⎢ⅈ⋅a₁₀⋅ℯ    ⋅sin(φ)⋅cosh(r₂) + a₂₀⋅cos(φ)⋅cosh(r₅) + ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r₂)⋅a₀₀ + cos(φ)⋅sinh
⎣a₃₀⎦   ⎢                                                                                             
        ⎢                                                             ___                             
        ⎣                                     a₃₀⋅cosh(r₆) + sinh(r₆)⋅a₂₀                             

        ⎤
        ⎥
        ⎥
     ___⎥
(r₅)⋅a₃₀⎥
        ⎥
     ___⎥
(r₅)⋅a₃₀⎥
        ⎥
        ⎥
        ⎦















                             ___
b₀ = a₀₀⋅cosh(r₁) + sinh(r₁)⋅a₁₀
          ⅈ⋅θ₀                                            ⅈ⋅θ₀                 ___                    
b₁ = a₁₀⋅ℯ    ⋅cos(φ)⋅cosh(r₂) + ⅈ⋅a₂₀⋅sin(φ)⋅cosh(r₅) + ℯ    ⋅cos(φ)⋅sinh(r₂)⋅a₀₀ + ⅈ⋅sin(φ)⋅sinh(r₅)

 ___
⋅a₃₀
            ⅈ⋅θ₀                                            ⅈ⋅θ₀                 ___                  
b₂ = ⅈ⋅a₁₀⋅ℯ    ⋅sin(φ)⋅cosh(r₂) + a₂₀⋅cos(φ)⋅cosh(r₅) + ⅈ⋅ℯ    ⋅sin(φ)⋅sinh(r₂)⋅a₀₀ + cos(φ)⋅sinh(r₅)

 ___
⋅a₃₀
                             ___
b₃ = a₃₀⋅cosh(r₆) + sinh(r₆)⋅a₂₀
